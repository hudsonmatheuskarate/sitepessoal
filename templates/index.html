<!doctype html>
{% load static %}
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hudson Matheus</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static 'style.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <style>
    /* Ajuste para o scroll não ficar cortado pelo menu */
    html {
      scroll-behavior: smooth;
    }
    
    /* Faz com que a seção HOME suba até o topo real */
    #home {
      scroll-margin-top: 0px;
    }

    section {
      scroll-margin-top: 80px; /* Ajuste conforme a altura do seu menu fixo */
    }

    .titulo-linha {
      width: 40px;
      height: 3px;
      background-color: #007bff;
      margin: 10px auto;
    }
  </style>
</head>

<body id="top">
  <header class="topbar">
    <div class="logo">
      <a href="#top" class="logo-icon">
        <img src="{% static 'img/logo.png' %}" alt="Hudson Matheus" />
      </a>
    </div>
    <nav class="main-nav">
      <a class="nav-item active" href="#top">Início</a>
      <a class="nav-item" href="{% url 'conquistas' %}">Conquistas</a>
      <a class="nav-item" href="#noticias">Notícias</a>
      <a class="nav-item" href="#contato">Contato</a>
    </nav>
    <!-- Search (replaces phone on desktop) -->
    <div class="site-search">
      <form action="{% url 'search_results' %}" method="get" class="search-form" onsubmit="return true;">
        <input id="siteSearchInput" name="q" type="search" placeholder="Pesquisar notícias e conquistas..." autocomplete="off">
      </form>
      <div id="searchPreview" class="search-preview" aria-hidden="true"></div>
    </div>
    <button class="hamburger" aria-label="Abrir menu" aria-expanded="false" aria-controls="mobileMenu">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <!-- New mobile toggle (replaces old hamburger on mobile) -->
    <button id="mobileToggle" aria-label="Abrir menu mobile" aria-expanded="false">
      <span class="bar"></span>
    </button>
  </header>
<!-- New mobile overlay + drawer -->
<div id="mobileOverlay" aria-hidden="true"></div>
<aside id="mobileDrawer" aria-hidden="true">
  <nav class="mobile-drawer-nav">
    <a class="mobile-drawer-item" href="#top">Início</a>
    <a class="mobile-drawer-item" href="{% url 'conquistas' %}">Conquistas</a>
    <a class="mobile-drawer-item" href="#noticias">Notícias</a>
    <a class="mobile-drawer-item" href="#contato">Contato</a>
  </nav>
  <div class="mobile-phone" style="margin-top:12px;color:#ddd">Telefone: (84) 9 9933-1686</div>
</aside>

<main id="home" class="hero">
  <div class="hero-overlay"></div>
  <div class="hero-content">
    <div class="portrait"></div>

    <img src="{% static 'img/titulocapa.png' %}" alt="Hudson Matheus" class="hero-name-img">

    <div class="ribbon">{% if bibliografia %}<a href="{{ bibliografia.get_absolute_url }}">Bibliografia</a>{% else %}Bibliografia{% endif %}</div>
    <p class="quote">Meu nome é Hudson Matheus</p>
  </div>
</main>

  <!-- mobile-bottom links moved to mobile hamburger menu -->

  <section id="conquistas-e-noticias" class="section py-5" style="background: linear-gradient(180deg,rgba(7,7,7,0.4),rgba(0,0,0,0.6)), hsl(0, 69%, 14%);">
  <div class="container-fluid px-md-5"> <div class="row">
      <div class="col-lg-7 col-md-12 mb-4">
        <div class="text-left mb-3">
          <h3 class="font-weight-bold">Minhas Conquistas</h3>
          <div style="width: 50px; height: 3px; background-color: #b90f0f;"></div>
        </div>

        <div id="carouselExampleIndicators" class="carousel slide shadow-lg rounded overflow-hidden" data-ride="carousel">
          <ol class="carousel-indicators">
            {% if conquistas %}
              {% for c in conquistas %}
                <li data-target="#carouselExampleIndicators" data-slide-to="{{ forloop.counter0 }}" class="{% if forloop.first %}active{% endif %}"></li>
              {% endfor %}
            {% else %}
              <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            {% endif %}
          </ol>
          <div class="carousel-inner">
            {% for c in conquistas %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <a href="{% url 'conquista_detail' c.slug %}">
                <img class="d-block w-100" src="{{ c.image.url }}" alt="{{ c.title }}">
              </a>
            </div>
            {% empty %}
            <div class="carousel-item active">
              <img class="d-block w-100" src="{% static 'img/Início.png' %}" alt="Primeira Conquista">
            </div>
            {% endfor %}
          </div>
          <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Anterior</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Próximo</span>
          </a>
        </div>
      </div>

      <div id="noticias" class="col-lg-5 col-md-12">
        <div class="text-left mb-3">
          <h3 class="font-weight-bold">Últimas Notícias</h3>
          <div style="width: 50px; height: 3px; background-color: #b90f0f;"></div>
        </div>

        <div id="newsCarousel" class="carousel slide shadow-sm" data-ride="carousel">
          <ol class="carousel-indicators">
            {% if noticias %}
              {% for n in noticias %}
                <li data-target="#newsCarousel" data-slide-to="{{ forloop.counter0 }}" class="{% if forloop.first %}active{% endif %}"></li>
              {% endfor %}
            {% else %}
              <li data-target="#newsCarousel" data-slide-to="0" class="active"></li>
            {% endif %}
          </ol>
          <div class="carousel-inner">
            {% for n in noticias %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <div class="card bg-dark border-secondary mb-3">
                <div class="row no-gutters">
                  <div class="col-4">
                    {% if n.image %}
                    <a href="{% url 'noticia_detail' n.slug %}"><img src="{{ n.image.url }}" class="card-img h-100" style="object-fit: cover;" alt="{{ n.title }}"></a>
                    {% else %}
                    <img src="{% static 'img/foto2.png' %}" class="card-img h-100" style="object-fit: cover;" alt="{{ n.title }}">
                    {% endif %}
                  </div>
                  <div class="col-8">
                    <div class="card-body p-2">
                      <h6 class="card-title mb-1"><a href="{% url 'noticia_detail' n.slug %}" style="color:inherit;text-decoration:none">{{ n.title }}</a></h6>
                      <p class="card-text small text-muted">{{ n.created_at|date:"d/m/Y" }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% empty %}
            <div class="carousel-item active">
              <div class="card bg-dark border-secondary mb-3">
                <div class="row no-gutters">
                  <div class="col-4"><img src="{% static 'img/foto2.png' %}" class="card-img h-100" style="object-fit: cover;" alt="..."></div>
                  <div class="col-8"><div class="card-body p-2"><h6 class="card-title mb-1">Nenhuma notícia</h6><p class="card-text small text-muted">Sem notícias publicadas.</p></div></div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
          <a class="carousel-control-prev" href="#newsCarousel" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Anterior</span>
          </a>
          <a class="carousel-control-next" href="#newsCarousel" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Próximo</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

  <section id="noticias" class="section noticias py-5">
    <div class="container">
      <div class="row mb-4">
        <div class="col-12 text-center">
          <h3 class="font-weight-bold mb-1">Patrocinadores</h3>
        </div>
      <div class="card-deck">
        <div class="card">
          <img class="card-img-top" src="{% static 'img/foto2.png' %}" alt="Card image cap">
          <div class="card-body">
            <h5 class="card-title">Título da Notícia</h5>
            <p class="card-text">Descrição breve da conquista ou novidade do atleta.</p>
            <p class="card-text"><small class="text-muted">Atualizado 3 min atrás</small></p>
          </div>
        </div>
        <div class="card">
          <img class="card-img-top" src="{% static 'img/foto2.png' %}" alt="Card image cap">
          <div class="card-body">
            <h5 class="card-title">Título da Notícia</h5>
            <p class="card-text">Descrição breve da conquista ou novidade do atleta.</p>
            <p class="card-text"><small class="text-muted">Atualizado 3 min atrás</small></p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="contato" class="section contato">
    <div class="section-inner text-center">
      <h2 class="section-title">Contato</h2>
      <p>Telefone: (84) 9 9933-1686 — Email: contato@hudsonmatheus.com</p>
    </div>
  </section>

  <footer class="main-footer">
    <div class="container">
      <div class="row">
        <div class="col-md-4 footer-column">
          <img src="{% static 'img/logo.png' %}" alt="Logo" class="footer-logo mb-3" style="max-height: 50px;">
          <p class="text-muted">Levando a disciplina e a força do esporte para o mundo. Hudson Matheus, Faixa Marrom.</p>
        </div>
        <div class="col-md-4 footer-column">
          <h5 class="footer-title">Links Rápidos</h5>
          <ul class="footer-links list-unstyled">
            <li><a href="#top">Início</a></li>
            <li><a href="{% url 'conquistas' %}">Conquistas</a></li>
            <li><a href="#noticias">Notícias</a></li>
            <li><a href="#contato">Contato</a></li>
          </ul>
        </div>
        <div class="col-md-4 footer-column">
          <h5 class="footer-title">Siga-me</h5>
          <div class="social-icons">
            <a href="#" class="social-link px-2"><i class="fab fa-instagram"></i></a>
            <a href="#" class="social-link px-2"><i class="fab fa-facebook-f"></i></a>
            <a href="https://wa.me/5584999331686" class="social-link px-2"><i class="fab fa-whatsapp"></i></a>
          </div>
        </div>
      </div>
      <hr class="footer-divider">
      <div class="footer-bottom text-center">
        <p>&copy; 2026 Hudson Matheus. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <script>
    // Inicializa o carousel para autoplay e garante comportamento consistente
    (function(){
      if (window.jQuery) {
        $(function(){
          var $c = $('#carouselExampleIndicators');
          if ($c.length) {
            $c.carousel({ interval: 3000, pause: 'hover' });
          }
        });
      }
    })();
  </script>

  <script>
    // Script para o ScrollSpy
    (function(){
      const navItems = document.querySelectorAll('.main-nav .nav-item, .mobile-bottom .mb-item');
      const sections = Array.from(document.querySelectorAll('section, main#home'));
      
      function onScroll(){
        const topOffset = 100;
        const y = window.scrollY + topOffset;
        let current = sections[0];
        for(const s of sections){
          if(s.offsetTop <= y) current = s;
        }
        
        navItems.forEach(a => {
          const target = a.getAttribute('href').replace('#', '');
          if(target === current.id || (target === 'top' && current.id === 'home')) {
            a.classList.add('active');
          } else {
            a.classList.remove('active');
          }
        });
      }

      window.addEventListener('scroll', onScroll, {passive:true});
    })();
  </script>
    <script>
      // Live search preview
      (function(){
        const input = document.getElementById('siteSearchInput');
        const preview = document.getElementById('searchPreview');
        let controller = null;
        function clearPreview(){ preview.innerHTML=''; preview.setAttribute('aria-hidden','true'); }
        function render(data){
          preview.innerHTML = '';
          const wrap = document.createElement('div');
          wrap.className = 'search-preview-wrap';

          const noticias = data.noticias || [];
          const conquistas = data.conquistas || [];

          if(noticias.length){
            const h = document.createElement('div'); h.className='preview-cat'; h.textContent='Notícias'; wrap.appendChild(h);
            noticias.forEach(n=>{
              const a = document.createElement('a');
              a.href = '/noticias/'+n.slug+'/';
              a.className='preview-item';
              a.innerHTML = `<div class="p-title">${n.title}</div><div class="p-meta">${n.created_at}</div>`;
              wrap.appendChild(a);
            });
          }

          if(conquistas.length){
            const h2 = document.createElement('div'); h2.className='preview-cat'; h2.textContent='Conquistas'; wrap.appendChild(h2);
            conquistas.forEach(c=>{
              const a = document.createElement('a');
              a.href = '/conquistas/'+c.slug+'/';
              a.className='preview-item';
              a.innerHTML = `<div class="p-title">${c.title}</div><div class="p-meta">${c.created_at}</div>`;
              wrap.appendChild(a);
            });
          }

          if(!noticias.length && !conquistas.length){
            const e = document.createElement('div'); e.className='preview-empty'; e.textContent='Nenhum resultado rápido encontrado'; wrap.appendChild(e);
          }

          preview.appendChild(wrap);
          preview.setAttribute('aria-hidden','false');
        }

        if(!input) return;
        input.addEventListener('input', function(){
          const q = this.value.trim();
          if(controller){ controller.abort(); controller = null; }
          if(!q){ clearPreview(); return; }
          controller = new AbortController();
          fetch(`/search_ajax/?q=${encodeURIComponent(q)}`, {signal: controller.signal})
            .then(r=>r.json())
            .then(data=> render(data))
            .catch(()=>{});
        });

        document.addEventListener('click', function(e){
          if(!preview.contains(e.target) && e.target !== input) clearPreview();
        });
      })();
    </script>
  <script>
    // Toggle do menu hamburguer mobile
    (function(){
      const oldBtn = document.querySelector('.hamburger');
      const btn = document.getElementById('mobileToggle');
      const overlay = document.getElementById('mobileOverlay');
      const drawer = document.getElementById('mobileDrawer');
      if(!btn || !overlay || !drawer) return;

      function open(){
        btn.classList.add('open');
        btn.setAttribute('aria-expanded','true');
        overlay.classList.add('open'); overlay.setAttribute('aria-hidden','false');
        drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false');
      }
      function close(){
        btn.classList.remove('open');
        btn.setAttribute('aria-expanded','false');
        overlay.classList.remove('open'); overlay.setAttribute('aria-hidden','true');
        drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true');
      }
      function toggle(){ if(drawer.classList.contains('open')) close(); else open(); }

      btn.addEventListener('click', function(e){ e.stopPropagation(); toggle(); });
      overlay.addEventListener('click', close);
      // close on Esc
      document.addEventListener('keydown', function(e){ if(e.key === 'Escape') close(); });
      // ensure clicking inside drawer does not close
      drawer.addEventListener('click', function(e){ e.stopPropagation(); });
      // optional: keep old button behavior non-breaking
      if(oldBtn){ oldBtn.addEventListener('click', function(e){ e.preventDefault(); toggle(); }); }
    })();
  </script>
</body>
</html>
