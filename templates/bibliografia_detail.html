{% load static %}
<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ bibliografia.title }}</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static 'style.css' %}">
  <style>
    .bibliografia-article { max-width:900px; margin: 0 auto; }
    .bibliografia-text { text-align: justify; text-justify: inter-word; }
    .bibliografia-centered { text-align: center; }
    .bibliografia-img { max-width:100%; height:auto; display:block; margin:12px auto; }
    .embed-youtube { width:100%; height:360px; max-width:840px; margin:12px auto; display:block }
    @media(max-width:600px){ .embed-youtube{height:200px} }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="logo">
      <a href="/" class="logo-icon"><img src="{% static 'img/logo.png' %}" alt="Logo"></a>
    </div>
    <nav class="main-nav">
      <a class="nav-item" href="/">Início</a>
      <a class="nav-item" href="{% url 'conquistas' %}">Conquistas</a>
      <a class="nav-item" href="#noticias">Notícias</a>
      <a class="nav-item" href="#contato">Contato</a>
    </nav>
    <div class="site-search">
      <form action="{% url 'search_results' %}" method="get" class="search-form">
        <input id="siteSearchInput" name="q" type="search" placeholder="Pesquisar notícias e conquistas..." autocomplete="off">
      </form>
      <div id="searchPreview" class="search-preview" aria-hidden="true"></div>
    </div>
    <button class="hamburger" aria-label="Abrir menu" aria-expanded="false" aria-controls="mobileMenu">
      <span></span><span></span><span></span>
    </button>
  </header>

  <main class="section py-5">
    <div class="container bibliografia-article">
      <h1 class="bibliografia-centered mb-4">{{ bibliografia.title }}</h1>

      {% for b in blocks %}
        {# If there's an uploaded image, show it centered (regardless of selected block_type) #}
        {% if b.image %}
          <img src="{{ b.image.url }}" alt="" class="bibliografia-img">
        {% endif %}

        {# Paragraph text (justified) #}
        {% if b.text and b.block_type == 'paragraph' %}
          <p class="bibliografia-text">{{ b.text|linebreaks }}</p>
        {% elif b.text and b.block_type != 'paragraph' and not b.image %}
          {# If text exists but block_type isn't paragraph and there's no image, show centered text #}
          <p class="bibliografia-centered">{{ b.text|linebreaks }}</p>
        {% endif %}

        {# YouTube embed (centered) #}
        {% if b.block_type == 'youtube' and b.youtube_url %}
          <div class="bibliografia-centered">
            <iframe class="embed-youtube" src="{{ b.youtube_embed_src }}" frameborder="0" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>
          </div>
        {% endif %}
      {% endfor %}

      <div class="share-buttons mt-4 bibliografia-centered">
        <a href="#" class="btn-share" id="share-facebook"><i class="fab fa-facebook-f"></i> Facebook</a>
        <a href="#" class="btn-share" id="share-whatsapp"><i class="fab fa-whatsapp"></i> WhatsApp</a>
        <a href="#" class="btn-share" id="share-instagram"><i class="fab fa-instagram"></i> Instagram</a>
      </div>
    </div>
  </main>

  <footer class="main-footer">
    <div class="container">
      <div class="footer-bottom text-center">
        <p>&copy; 2026 Hudson Matheus. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
  <script>
    (function(){
      const url = window.location.href;
      const title = document.title;

      document.getElementById('share-facebook').addEventListener('click', function(e){
        e.preventDefault();
        const shareUrl = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(url);
        window.open(shareUrl,'_blank','width=600,height=400');
      });

      document.getElementById('share-whatsapp').addEventListener('click', function(e){
        e.preventDefault();
        const shareUrl = 'https://wa.me/?text=' + encodeURIComponent(title + ' ' + url);
        window.open(shareUrl,'_blank');
      });

      document.getElementById('share-instagram').addEventListener('click', async function(e){
        e.preventDefault();
        try{
          await navigator.clipboard.writeText(url);
          alert('Link copiado para a área de transferência. Abra o Instagram e cole o link na descrição ou mensagem.');
        }catch(err){
          prompt('Copie o link abaixo e cole no Instagram:', url);
        }
      });
    })();
  </script>
</body>
</html>
